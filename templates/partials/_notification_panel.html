<style>
  /* ì•Œë¦¼ íŒ¨ë„ - ì˜¤ë¥¸ìª½ì—ì„œ ì™¼ìª½ìœ¼ë¡œ í¼ì³ì§ */
  .notification-panel {
    position: fixed;
    right: 0;
    top: 68px;
    width: 340px;
    max-width: calc(100vw - 24px);
    height: calc(100vh - 68px);
    background: var(--bg-white);
    border-left: 1px solid var(--border-gray);
    box-shadow: -4px 0 20px rgba(0,0,0,0.08);
    z-index: 95;
    display: flex;
    flex-direction: column;
    transform: translateX(100%);
    transition: transform 0.3s ease;
  }
  .notification-panel.open {
    transform: translateX(0);
  }
  .notification-panel .panel-header {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 24px 40px 24px 20px;
    border-bottom: 1px solid var(--border-gray);
    flex-shrink: 0;
    background: var(--bg-white);
  }
  .notification-panel .panel-title {
    font-size: 1rem;
    font-weight: 700;
    color: var(--text-dark);
    margin-bottom: 12px;
  }
  .notification-panel .panel-stats {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-dark);
  }
  .notification-panel .panel-stats span {
    display: flex;
    align-items: center;
    gap: 4px;
  }
  .notification-panel .panel-stats .count {
    font-weight: 700;
    color: var(--main-purple);
  }
  .notification-panel .panel-close {
    position: absolute;
    top: 20px;
    right: 16px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px;
    color: var(--gray-muted);
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .notification-panel .panel-close:hover {
    color: var(--main-purple);
  }
  .notification-panel .panel-body {
    flex: 1;
    overflow-y: auto;
    padding: 8px 0;
  }
  .notification-panel .notification-item {
    display: flex;
    gap: 12px;
    padding: 14px 20px;
    border-bottom: 1px solid var(--border-gray);
    cursor: pointer;
    transition: background 0.2s;
  }
  .notification-panel .notification-item:hover {
    background: var(--soft-purple);
  }
  .notification-panel .notification-item.unread {
    background: #f0f9ff;
  }
  .notification-panel .notification-item .noti-icon {
    width: 36px;
    height: 36px;
    min-width: 36px;
    border-radius: 50%;
    background: var(--soft-purple);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    color: var(--main-purple);
  }
  .notification-panel .notification-item .noti-content {
    flex: 1;
    min-width: 0;
  }
  .notification-panel .notification-item .noti-title {
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-dark);
    margin-bottom: 4px;
  }
  .notification-panel .notification-item .noti-desc {
    font-size: 0.8rem;
    color: var(--gray-muted);
    line-height: 1.4;
  }
  .notification-panel .notification-item .noti-time {
    font-size: 0.72rem;
    color: var(--gray-muted);
    margin-top: 4px;
  }
  .notification-panel .empty-state {
    padding: 48px 24px;
    text-align: center;
    color: var(--gray-muted);
    font-size: 0.9rem;
  }
  @media (max-width: 1100px) {
    .notification-panel { display: none; }
  }
</style>

<aside class="notification-panel" id="notificationPanel">
  <div class="panel-header">
    <button type="button" class="panel-close" id="notificationPanelClose" title="ë‹«ê¸°" aria-label="ë‹«ê¸°">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
    </button>
    <div class="panel-title">ì•Œë¦¼ëª©ë¡</div>
    <div class="panel-stats">
      <span>ì½ìŒ <span class="count" id="notiReadCount">0</span>ê±´</span>
      <span>ì•ˆì½ìŒ <span class="count" id="notiUnreadCount">0</span>ê±´</span>
      <span>ì´ <span class="count" id="notiTotalCount">0</span>ê±´</span>
    </div>
  </div>
  <div class="panel-body" id="notificationList">
    <div class="empty-state">ìƒˆ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>
  </div>
</aside>

<script>
(function() {
  const panel = document.getElementById('notificationPanel');
  const closeBtn = document.getElementById('notificationPanelClose');
  const listEl = document.getElementById('notificationList');
  const readCountEl = document.getElementById('notiReadCount');
  const unreadCountEl = document.getElementById('notiUnreadCount');
  const totalCountEl = document.getElementById('notiTotalCount');

  if (!panel) return;

  function openPanel() {
    panel.classList.add('open');
  }
  function closePanel() {
    panel.classList.remove('open');
  }
  function togglePanel() {
    panel.classList.toggle('open');
  }

  // ì•Œë¦¼ ë²„íŠ¼ í´ë¦­
  document.querySelectorAll('.nav-btn-icon[title="ì•Œë¦¼"], #navNotificationBtn').forEach(function(btn) {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      togglePanel();
    });
  });

  // ë‹«ê¸° ë²„íŠ¼
  if (closeBtn) closeBtn.addEventListener('click', closePanel);

  // ë°”ê¹¥ í´ë¦­ ì‹œ ë‹«ê¸° (ì˜µì…˜)
  document.addEventListener('click', function(e) {
    if (panel.classList.contains('open') && !panel.contains(e.target) && !e.target.closest('.nav-btn-icon') && !e.target.closest('#navNotificationBtn')) {
      closePanel();
    }
  });

  function renderNotifications(items) {
    if (!items || items.length === 0) {
      listEl.innerHTML = '<div class="empty-state">ìƒˆ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
      if (readCountEl) readCountEl.textContent = '0';
      if (unreadCountEl) unreadCountEl.textContent = '0';
      if (totalCountEl) totalCountEl.textContent = '0';
      return;
    }
    const readCount = items.filter(function(i) { return i.read; }).length;
    const unreadCount = items.length - readCount;
    if (readCountEl) readCountEl.textContent = String(readCount);
    if (unreadCountEl) unreadCountEl.textContent = String(unreadCount);
    if (totalCountEl) totalCountEl.textContent = String(items.length);
    listEl.innerHTML = items.map(function(n) {
      const cls = n.read ? '' : ' unread';
      const icon = n.icon || 'ğŸ””';
      return '<div class="notification-item' + cls + '" data-id="' + (n.id || '') + '">' +
        '<div class="noti-icon">' + icon + '</div>' +
        '<div class="noti-content">' +
          '<div class="noti-title">' + (n.title || 'ì•Œë¦¼') + '</div>' +
          (n.desc ? '<div class="noti-desc">' + n.desc + '</div>' : '') +
          (n.time ? '<div class="noti-time">' + n.time + '</div>' : '') +
        '</div>' +
      '</div>';
    }).join('');
  }

  // ìƒ˜í”Œ ë°ì´í„° (ì¶”í›„ /api/notifications ë¡œ êµì²´)
  var sampleItems = [
    { id: '1', title: 'ìƒˆ ê³µëª¨ì „ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤', desc: '[2025 ëŒ€í•™ìƒ ê´‘ê³  ê³µëª¨ì „] ë§ˆê°ì´ 7ì¼ ë‚¨ì•˜ìŠµë‹ˆë‹¤.', time: 'ë°©ê¸ˆ ì „', read: false },
    { id: '2', title: 'íŒ€ì›ì´ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤', desc: 'í™ê¸¸ë™ë‹˜ì´ ìƒíƒœ ë©”ì‹œì§€ë¥¼ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.', time: '1ì‹œê°„ ì „', read: false },
    { id: '3', title: 'ë§ˆê° ì•Œë¦¼', desc: 'OO ê³µëª¨ì „ ì ‘ìˆ˜ ë§ˆê°ì´ ë‚´ì¼ì…ë‹ˆë‹¤.', time: 'ì–´ì œ', read: true }
  ];
  renderNotifications(sampleItems);
})();
</script>
