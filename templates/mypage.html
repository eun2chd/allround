<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/favicon.png') }}">
  <title>{{ 'ë§ˆì´í˜ì´ì§€' if is_own_profile else (profile.get('nickname', '') or 'íšŒì›') + ' í”„ë¡œí•„' }} | Ntpercent</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">
  <style>
    @font-face {
      font-family: 'Pretendard Variable';
      src: url("{{ url_for('static', filename='font/PretendardVariable.ttf') }}") format('truetype');
      font-weight: 100 900;
      font-style: normal;
    }
    :root {
      --main-purple: #6d28d9;
      --main-purple-hover: #5b21b6;
      --soft-purple: #ede9fe;
      --text-dark: #212121;
      --gray-muted: #9ca3af;
      --bg-white: #ffffff;
      --border-gray: #e5e7eb;
      --radius: 8px;
      --radius-lg: 12px;
      --font: 'Pretendard Variable', 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: var(--font);
      background: #f9fafb;
      color: var(--text-dark);
      font-weight: 500;
      min-height: 100vh;
      line-height: 1.5;
    }
    .container { max-width: 960px; margin: 0 auto; padding: 24px; }
    .page-header {
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 1px solid var(--border-gray);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 12px;
    }
    .page-header h1 {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text-dark);
      margin: 0;
    }
    /* í”„ë¡œí•„ ì˜ì—­ */
    .profile-section {
      background: linear-gradient(135deg, #ede9fe 0%, #6d28d9 100%);
      border-radius: var(--radius-lg);
      padding: 32px;
      display: flex;
      flex-direction: column;
      gap: 0;
      margin-bottom: 24px;
    }
    .profile-section .profile-top {
      display: flex;
      align-items: center;
      gap: 24px;
      position: relative;
      z-index: 1;
    }
    .profile-section .profile-status-row,
    .profile-section .level-exp-block {
      position: relative;
      z-index: 1;
    }
    .profile-section .profile-status-row {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(0,0,0,0.06);
      width: 100%;
    }
    .profile-section .profile-status-row .status-input {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid var(--border-gray);
      border-radius: var(--radius);
      font-family: var(--font);
      font-size: 0.9rem;
    }
    .profile-section .profile-status-row .status-input:focus {
      outline: none;
      border-color: var(--main-purple);
      box-shadow: 0 0 0 2px rgba(109,40,217,0.15);
    }
    .profile-section .profile-status-row .status-row-inner {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .profile-section .profile-status-row .status-row-inner .status-input { flex: 1; }
    .profile-section .profile-status-row .btn-clear-status {
      flex-shrink: 0;
      padding: 8px 14px;
      font-family: var(--font);
      font-size: 0.85rem;
      color: var(--gray-muted);
      background: var(--bg-white);
      border: 1px solid var(--border-gray);
      border-radius: var(--radius);
      cursor: pointer;
      transition: all 0.2s;
    }
    .profile-section .profile-status-row .btn-clear-status:hover {
      color: #dc2626;
      border-color: #dc2626;
      background: #fef2f2;
    }
    .profile-section .profile-status-row .btn-save-status {
      flex-shrink: 0;
      padding: 8px 16px;
      font-family: var(--font);
      font-size: 0.85rem;
      font-weight: 500;
      color: #fff;
      background: var(--main-purple);
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: background 0.2s;
    }
    .profile-section .profile-status-row .btn-save-status:hover {
      background: var(--main-purple-hover);
    }
    .profile-section .avatar-wrap { position: relative; }
    .profile-section .avatar {
      width: 96px;
      height: 96px;
      border-radius: 50%;
      background: var(--bg-white);
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.25rem;
      font-weight: 600;
      color: var(--main-purple);
    }
    .profile-section .avatar.legend-border {
      border: 3px solid #e8b923;
      box-shadow: 0 0 12px rgba(229, 185, 35, 0.5), inset 0 0 0 1px rgba(255,255,255,0.3);
    }
    /* Tier ìŠ¤íƒ€ì¼ */
    .profile-section.tier-0 {
      background: var(--bg-white);
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      border: 1px solid var(--border-gray);
    }
    .profile-section.tier-1 {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border: 2px solid #94a3b8;
      box-shadow: 0 0 20px rgba(148, 163, 184, 0.4), inset 0 0 40px rgba(255,255,255,0.5);
    }
    .profile-section.tier-1 .avatar { box-shadow: 0 0 16px rgba(148, 163, 184, 0.6); border: 2px solid #94a3b8; }
    .profile-section.tier-2 {
      background: linear-gradient(135deg, #fef9c3 0%, #fde68a 50%, #fcd34d 100%);
      border: 2px solid #e8b923;
      position: relative;
      overflow: visible;
    }
    .profile-section.tier-2::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.4) 50%, transparent 100%);
      animation: shimmer 3s ease-in-out infinite;
    }
    @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
    /* Tier 2: í”„ë¡œí•„ ì˜ì—­ Border Animation (í…Œë‘ë¦¬ ë°”ê¹¥ìª½ ë”°ë¼ ë¹› ì´ë™) */
    .profile-section.tier-2 .profile-border-svg {
      position: absolute;
      inset: -4px;
      width: calc(100% + 8px);
      height: calc(100% + 8px);
      border-radius: calc(var(--radius-lg) + 4px);
      pointer-events: none;
      z-index: 2;
    }
    .profile-section.tier-2 .profile-border-svg rect {
      fill: none;
      stroke: url(#goldSectionGradient);
      stroke-width: 3;
      stroke-linecap: round;
      stroke-dasharray: 280 1320;
      animation: profile-border-travel 5s linear infinite;
    }
    @keyframes profile-border-travel { to { stroke-dashoffset: 1600; } }
    .profile-section.tier-3 {
      background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4c1d95 100%);
      border: 2px solid rgba(255,255,255,0.15);
      position: relative;
      overflow: visible;
    }
    /* Tier 3: í…Œë‘ë¦¬ ë°”ê¹¥ìª½ ë”°ë¼ ì´ë™í•˜ëŠ” ë¬´ì§€ê°œ ë¹› (íšŒì „ ì—†ìŒ) */
    .profile-section.tier-3 .profile-border-svg {
      position: absolute;
      inset: -4px;
      width: calc(100% + 8px);
      height: calc(100% + 8px);
      border-radius: calc(var(--radius-lg) + 4px);
      pointer-events: none;
      z-index: 2;
    }
    .profile-section.tier-3 .profile-border-svg rect {
      fill: none;
      stroke: url(#rainbowSectionGradient);
      stroke-width: 3;
      stroke-linecap: round;
      stroke-dasharray: 280 1320;
      animation: profile-border-travel 5s linear infinite;
    }
    .profile-section.tier-3 .info h2,
    .profile-section.tier-3 .profile-tagline,
    .profile-section.tier-3 .info p { color: rgba(255,255,255,0.95); }
    .profile-section.tier-3 .profile-tagline { color: #fde68a; }
    .profile-section.tier-3 .summary-label,
    .profile-section.tier-3 .profile-status-row { border-color: rgba(255,255,255,0.15); }
    /* Tier 3 íŒŒí‹°í´ */
    .profile-section.tier-3 .tier-particles {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }
    .tier-particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(255,255,255,0.5);
      border-radius: 50%;
      animation: particle-float 8s ease-in-out infinite;
    }
    .tier-particle:nth-child(1) { left: 10%; top: 20%; animation-delay: 0s; }
    .tier-particle:nth-child(2) { left: 25%; top: 60%; animation-delay: 1s; }
    .tier-particle:nth-child(3) { left: 60%; top: 15%; animation-delay: 2s; }
    .tier-particle:nth-child(4) { left: 80%; top: 70%; animation-delay: 0.5s; }
    .tier-particle:nth-child(5) { left: 45%; top: 85%; animation-delay: 1.5s; }
    .tier-particle:nth-child(6) { left: 90%; top: 40%; animation-delay: 2.5s; }
    @keyframes particle-float {
      0%, 100% { transform: translate(0,0) scale(1); opacity: 0.5; }
      50% { transform: translate(10px,-15px) scale(1.2); opacity: 0.9; }
    }
    .legend-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      font-size: 0.75rem;
      font-weight: 700;
      color: #b45309;
      background: linear-gradient(180deg, #fef3c7 0%, #fde68a 100%);
      border: 1px solid #e8b923;
      border-radius: 20px;
    }
    .profile-section.tier-3 .legend-badge {
      color: #fff;
      background: linear-gradient(135deg, #8b5cf6, #ec4899);
      border-color: rgba(255,255,255,0.5);
    }
    .profile-tagline {
      font-size: 0.9rem;
      color: var(--main-purple);
      font-weight: 600;
      margin-top: 4px;
    }
    .profile-section .btn-avatar-upload {
      position: absolute;
      bottom: 0;
      right: 0;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--main-purple);
      color: #fff;
      border: 2px solid var(--bg-white);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      padding: 0;
      transition: background 0.2s;
    }
    .profile-section .btn-avatar-upload:hover { background: var(--main-purple-hover); }
    .profile-section .btn-avatar-upload input { display: none; }
    .profile-section .info { flex: 1; }
    .profile-section .info h2 {
      font-size: 1.35rem;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .role-badge {
      display: inline-block;
      padding: 4px 10px;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--main-purple);
      background: var(--bg-white);
      border-radius: 20px;
    }
    .profile-section.tier-3 .role-badge {
      background: rgba(255,255,255,0.2);
      color: #e9d5ff;
    }
    .profile-section .info p { font-size: 0.9rem; color: var(--gray-muted); }
    .profile-section .profile-top .profile-logout { flex-shrink: 0; margin-left: auto; }
    /* ë ˆë²¨/EXP ë°” */
    .level-exp-block {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid rgba(0,0,0,0.06);
      width: 100%;
    }
    .profile-section.tier-3 .level-exp-block { border-color: rgba(255,255,255,0.2); }
    .level-exp-row {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 8px;
    }
    .level-exp-info {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-dark);
    }
    .profile-section.tier-3 .level-exp-info { color: #fff; }
    .level-exp-info .tier-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 6px;
      font-size: 0.75rem;
      margin-left: 6px;
      font-weight: 700;
    }
    .tier-badge.bronze { background: #f5e6d3; color: #92400e; }
    .tier-badge.silver { background: #e5e7eb; color: #4b5563; }
    .tier-badge.gold { background: linear-gradient(180deg, #fef3c7, #fde68a); color: #b45309; }
    .tier-badge.legend { background: linear-gradient(135deg, #8b5cf6, #ec4899); color: #fff; }
    .exp-bar-wrap {
      height: 12px;
      background: rgba(0,0,0,0.1);
      border-radius: 999px;
      overflow: hidden;
      flex: 1;
      min-width: 120px;
    }
    .profile-section.tier-3 .exp-bar-wrap { background: rgba(255,255,255,0.2); }
    .exp-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--main-purple), #a78bfa);
      border-radius: 999px;
      transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .exp-bar-fill.gold { background: linear-gradient(90deg, #e8b923, #fcd34d); }
    .exp-bar-fill.legend { background: linear-gradient(90deg, #8b5cf6, #ec4899); }
    .exp-next-hint {
      font-size: 0.8rem;
      color: var(--gray-muted);
      margin-top: 6px;
    }
    .profile-section.tier-3 .exp-next-hint { color: rgba(255,255,255,0.7); }
    /* ë¶„ì•¼ ì „ë¬¸ì„± íƒœê·¸ */
    .expertise-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }
    .expertise-tag {
      display: inline-block;
      padding: 6px 12px;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--main-purple);
      background: rgba(255,255,255,0.9);
      border: 1px solid rgba(109,40,217,0.3);
      border-radius: 20px;
      text-decoration: none;
      transition: all 0.2s;
    }
    .expertise-tag:hover { background: var(--soft-purple); border-color: var(--main-purple); }
    .profile-section.tier-3 .expertise-tag {
      background: rgba(255,255,255,0.15);
      border-color: rgba(255,255,255,0.4);
      color: #fde68a;
    }
    .profile-section.tier-3 .expertise-tag:hover {
      background: rgba(255,255,255,0.25);
      border-color: rgba(255,255,255,0.6);
    }
    /* ëŒ€í‘œ ì‘í’ˆ (Pinned Portfolio) */
    .pinned-portfolio-section {
      margin-bottom: 24px;
    }
    .pinned-portfolio-section h3 {
      font-size: 1rem;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-gray);
    }
    .pinned-cards {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
    }
    @media (max-width: 768px) {
      .pinned-cards { grid-template-columns: 1fr; }
    }
    .pinned-card {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      transition: transform 0.2s, box-shadow 0.2s;
      text-decoration: none;
      color: inherit;
      display: block;
    }
    .pinned-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.1);
    }
    .pinned-card-thumb {
      aspect-ratio: 4/3;
      background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
      background-size: cover;
      background-position: center;
      position: relative;
    }
    .pinned-card-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 10px;
      font-size: 0.7rem;
      font-weight: 700;
      color: #b45309;
      background: linear-gradient(180deg, #fef3c7, #fde68a);
      border: 1px solid #e8b923;
      border-radius: 20px;
    }
    .pinned-card-title {
      padding: 14px;
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-dark);
    }
    /* ì¹´ë“œ ê³µí†µ */
    .card {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      overflow: hidden;
    }
    /* ê³„ì • ì •ë³´ ì¹´ë“œ */
    .account-card {
      padding: 0;
      margin-bottom: 24px;
    }
    .account-card .card-title {
      padding: 20px 24px;
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-dark);
      border-bottom: 1px solid var(--border-gray);
    }
    .account-card .card-body {
      padding: 20px 24px;
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 16px 24px;
    }
    @media (max-width: 600px) {
      .account-card .card-body { grid-template-columns: 1fr; }
    }
    .account-card .row {
      display: contents;
    }
    .account-card .label {
      font-size: 0.9rem;
      color: var(--gray-muted);
    }
    .account-card .value {
      font-size: 0.9rem;
      color: var(--text-dark);
    }
    /* ìš”ì•½ ëŒ€ì‹œë³´ë“œ */
    .dashboard-summary {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }
    @media (max-width: 768px) {
      .dashboard-summary { grid-template-columns: 1fr; }
    }
    .summary-card {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .summary-card .summary-icon {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }
    .summary-card .summary-icon.trophy { background: linear-gradient(135deg, #fef3c7, #fde68a); }
    .summary-card .summary-icon.money { background: linear-gradient(135deg, #d1fae5, #a7f3d0); }
    .summary-card .summary-icon.rocket { background: linear-gradient(135deg, #e0e7ff, #c7d2fe); }
    .summary-card .summary-value { font-size: 1.25rem; font-weight: 700; color: var(--text-dark); }
    .summary-card .summary-label { font-size: 0.85rem; color: var(--gray-muted); margin-top: 2px; }
    /* ê³µëª¨ì „ íƒ€ì„ë¼ì¸ */
    .timeline-section {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      padding: 24px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
      margin-bottom: 24px;
    }
    .timeline-section h3 {
      font-size: 1rem;
      font-weight: 700;
      color: var(--text-dark);
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-gray);
    }
    .timeline-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 14px 0;
      border-bottom: 1px solid var(--border-gray);
    }
    .timeline-item:last-child { border-bottom: none; }
    .timeline-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-top: 6px;
      flex-shrink: 0;
    }
    .timeline-dot.win { background: var(--main-purple); }
    .timeline-dot.lose { background: var(--gray-muted); }
    .timeline-content { flex: 1; min-width: 0; }
    .timeline-title { font-size: 0.95rem; font-weight: 600; color: var(--text-dark); margin-bottom: 4px; }
    .timeline-meta { font-size: 0.82rem; color: var(--gray-muted); display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
    .timeline-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    .timeline-badge.award { background: var(--soft-purple); color: var(--main-purple); }
    .timeline-badge.eliminated { background: #fef2f2; color: #dc2626; }
    .timeline-link { font-size: 0.8rem; color: var(--main-purple); text-decoration: none; }
    .timeline-link:hover { text-decoration: underline; }
    .actions-section {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      padding-top: 24px;
      border-top: 1px solid var(--border-gray);
    }
    .btn-outline {
      padding: 12px 24px;
      font-family: var(--font);
      font-size: 0.95rem;
      font-weight: 500;
      background: var(--bg-white);
      color: var(--main-purple);
      border: 2px solid var(--main-purple);
      border-radius: var(--radius);
      cursor: pointer;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      transition: all 0.2s;
    }
    .btn-outline:hover {
      background: var(--soft-purple);
    }
    .btn-outline.danger {
      color: #dc2626;
      border-color: #dc2626;
    }
    .btn-outline.danger:hover {
      background: #fef2f2;
    }
    /* ì•ˆë‚´ ë²„íŠ¼ */
    .info-buttons {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .btn-info {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--soft-purple);
      color: var(--main-purple);
      border: 1px solid rgba(109,40,217,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.2s;
    }
    .btn-info:hover {
      background: var(--main-purple);
      color: #fff;
      border-color: var(--main-purple);
    }
    .btn-info svg { width: 18px; height: 18px; }
    /* ëª¨ë‹¬ */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }
    .modal-overlay.active { display: flex; }
    .modal-box {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      max-width: 480px;
      width: 100%;
      max-height: 85vh;
      overflow-y: auto;
      box-shadow: 0 24px 48px rgba(0,0,0,0.15);
    }
    .modal-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-gray);
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }
    .modal-header h4 {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text-dark);
      margin: 0;
    }
    .modal-close {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      border: none;
      background: transparent;
      color: var(--gray-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      transition: color 0.2s;
    }
    .modal-close:hover { color: var(--text-dark); }
    .modal-body {
      padding: 24px;
      font-size: 0.9rem;
      line-height: 1.7;
      color: var(--text-dark);
    }
    .modal-body table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      margin: 16px 0;
    }
    .modal-body th, .modal-body td {
      padding: 10px 12px;
      text-align: left;
      border: 1px solid var(--border-gray);
    }
    .modal-body th {
      background: var(--soft-purple);
      color: var(--main-purple);
      font-weight: 600;
    }
    .modal-body .info-item {
      margin-bottom: 16px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--border-gray);
    }
    .modal-body .info-item:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
    .modal-body .info-item strong { color: var(--main-purple); }
  </style>
</head>
<body>
  {% include 'partials/_navbar.html' %}

  <div class="container">
    <header class="page-header">
      <h1>{{ 'ë§ˆì´í˜ì´ì§€' if is_own_profile else 'í”„ë¡œí•„' }}</h1>
      <div class="info-buttons">
        {% if is_own_profile %}
        <button type="button" class="btn-info" onclick="openModal('modalTier')" title="í‹°ì–´ ì‹œìŠ¤í…œ ì•ˆë‚´">ğŸ†</button>
        <button type="button" class="btn-info" onclick="openModal('modalTags')" title="ë¶„ì•¼ íƒœê·¸ ì•ˆë‚´">#</button>
        <button type="button" class="btn-info" onclick="openModal('modalHeadline')" title="í—¤ë“œë¼ì¸ ì•ˆë‚´">âœ¨</button>
        {% endif %}
        {% if not is_own_profile %}
        <a href="{{ url_for('home') }}" class="btn-outline">í™ˆìœ¼ë¡œ</a>
        {% endif %}
      </div>
    </header>

    {% if is_own_profile %}
    <!-- ê³„ì • ì •ë³´ ì¹´ë“œ -->
    <div class="card account-card">
      <div class="card-title">ê³„ì • ì •ë³´</div>
      <div class="card-body">
        <span class="label">ì´ë©”ì¼</span>
        <span class="value">{{ profile.get('email', '-') }}</span>
        <span class="label">ë‹‰ë„¤ì„</span>
        <span class="value">{{ profile.get('nickname', '-') }}</span>
      </div>
    </div>
    {% endif %}

    <!-- í”„ë¡œí•„ ì˜ì—­ (Tierì— ë”°ë¼ tier-0~3 í´ë˜ìŠ¤ ì ìš©) -->
    <section class="profile-section tier-{{ tier_level }}">
      {% if tier_level >= 2 %}
      <svg class="profile-border-svg" viewBox="0 0 500 300" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="goldSectionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#e8b923" />
            <stop offset="50%" stop-color="#fcd34d" />
            <stop offset="100%" stop-color="#fde68a" />
          </linearGradient>
          <linearGradient id="rainbowSectionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="#f59e0b" />
            <stop offset="25%" stop-color="#ec4899" />
            <stop offset="50%" stop-color="#8b5cf6" />
            <stop offset="75%" stop-color="#06b6d4" />
            <stop offset="100%" stop-color="#f59e0b" />
          </linearGradient>
        </defs>
        <rect x="1.5" y="1.5" width="497" height="297" rx="12" ry="12" />
      </svg>
      {% endif %}
      {% if tier_level >= 3 %}
      <div class="tier-particles">
        <span class="tier-particle"></span><span class="tier-particle"></span><span class="tier-particle"></span>
        <span class="tier-particle"></span><span class="tier-particle"></span><span class="tier-particle"></span>
      </div>
      {% endif %}
      <div class="profile-top">
        <div class="avatar-wrap">
          <div class="avatar {% if tier_level >= 2 %}legend-border{% endif %}" id="profileAvatar" style="background-image: url('{{ profile.get('profile_url') or '' }}')">
            {% if not profile.get('profile_url') %}<span>{{ (profile.get('nickname') or '?')[:1] }}</span>{% endif %}
          </div>
          {% if is_own_profile %}
          <label class="btn-avatar-upload" title="í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½">
            <input type="file" id="avatarInput" accept="image/jpeg,image/png,image/gif,image/webp">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
          </label>
          {% endif %}
        </div>
        <div class="info">
          <h2>
            {{ profile.get('nickname', '') or 'íšŒì›' }}
            {% if tier_level >= 3 %}<span class="legend-badge">LEGEND</span>{% endif %}
            <span class="role-badge">{{ role_label }}</span>
          </h2>
          <p class="profile-tagline">
            {% if tier_level >= 3 %}AI ë””ìì¸ ë¶„ì•¼ ëˆ„ì  ìƒê¸ˆ 1ìœ„ Â· ë ˆì „ë“œ í¬ë¦¬ì—ì´í„°{% elif tier_level == 2 %}AI ë””ìì¸ ë¶„ì•¼ ìƒìœ„ 5% Â· GOLD í¬ë¦¬ì—ì´í„°{% elif tier_level == 1 %}ìˆ˜ìƒ í¬ë¦¬ì—ì´í„° Â· SILVER Tier{% else %}ìƒˆë¡œìš´ ë„ì „ì„ ì‹œì‘í•´ë³´ì„¸ìš”{% endif %}
          </p>
          <div class="expertise-tags">
            {% for tag in expertise_tags %}
            <span class="expertise-tag">#{{ tag }}</span>
            {% endfor %}
          </div>
          {% if is_own_profile %}
          <p style="font-size:0.85rem;color:var(--gray-muted);margin-top:8px;">{{ profile.get('email', '') }}</p>
          {% endif %}
        </div>
        {% if is_own_profile %}
        <a href="{{ url_for('mypage_password') }}" class="btn-outline profile-logout">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</a>
        {% endif %}
      </div>
      <!-- ë ˆë²¨/EXP ë°” -->
      <div class="level-exp-block">
        <div class="level-exp-row">
          <span class="level-exp-info">Lv.{{ level }} Â· <span class="tier-badge {{ tier_name|lower }}">{{ tier_name }} Tier</span></span>
          <div class="exp-bar-wrap">
            <div class="exp-bar-fill {% if tier_level >= 3 %}legend{% elif tier_level >= 2 %}gold{% endif %}" style="width: {{ exp_percent }}%"></div>
          </div>
        </div>
        <p class="exp-next-hint">ë‹¤ìŒ ë ˆë²¨ê¹Œì§€ {{ exp_next - exp_current }} EXP í•„ìš” ({{ exp_percent }}% ì™„ë£Œ)</p>
      </div>
      {% if is_own_profile %}
      <div class="profile-status-row">
        <div class="status-row-inner">
          <input type="text" class="status-input" id="statusInput" value="{{ profile.get('status_message') or '' }}" placeholder="ìƒíƒœ ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì´ë²ˆ ì£¼ OO ê³µëª¨ì „ ë§ˆê°ì…ë‹ˆë‹¤!)" maxlength="80">
          <button type="button" class="btn-save-status" id="btnSaveStatus" title="ì €ì¥">ì €ì¥</button>
          <button type="button" class="btn-clear-status" id="btnClearStatus" title="ìƒíƒœ ë©”ì‹œì§€ ì‚­ì œ">ì‚­ì œ</button>
        </div>
      </div>
      {% endif %}
    </section>

    <!-- ëŒ€í‘œ ì‘í’ˆ (Pinned Portfolio) -->
    <section class="pinned-portfolio-section">
      <h3>ëŒ€í‘œ ì‘í’ˆ</h3>
      <div class="pinned-cards">
        {% for item in pinned_portfolio %}
        <a href="{{ item.url or '#' }}" class="pinned-card" target="_blank">
          <div class="pinned-card-thumb" style="{% if item.thumbnail %}background-image: url('{{ item.thumbnail }}');{% endif %}">
            <span class="pinned-card-badge">{{ item.award or 'ìˆ˜ìƒ' }}</span>
          </div>
          <div class="pinned-card-title">{{ item.title or 'ì‘í’ˆ ì œëª©' }}</div>
        </a>
        {% endfor %}
      </div>
    </section>

    <!-- ìš”ì•½ ëŒ€ì‹œë³´ë“œ -->
    <section class="dashboard-summary">
      <div class="summary-card">
        <div class="summary-icon trophy">ğŸ†</div>
        <div>
          <div class="summary-value">5ê±´</div>
          <div class="summary-label">ìˆ˜ìƒ</div>
        </div>
      </div>
      <div class="summary-card">
        <div class="summary-icon money">ğŸ’°</div>
        <div>
          <div class="summary-value">1,250ë§Œì›</div>
          <div class="summary-label">ìƒê¸ˆ</div>
        </div>
      </div>
      <div class="summary-card">
        <div class="summary-icon rocket">ğŸš€</div>
        <div>
          <div class="summary-value">20ê±´</div>
          <div class="summary-label">ë„ì „</div>
        </div>
      </div>
    </section>

    <!-- ê³µëª¨ì „ íƒ€ì„ë¼ì¸ -->
    <section class="timeline-section">
      <h3>ê³µëª¨ì „ íƒ€ì„ë¼ì¸</h3>
      <div class="timeline-item">
        <div class="timeline-dot win"></div>
        <div class="timeline-content">
          <div class="timeline-title">OOë¸Œëœë“œ ë¡œê³  ê³µëª¨ì „</div>
          <div class="timeline-meta">
            <span>2026.02</span>
            <span class="timeline-badge award">ìµœìš°ìˆ˜ìƒ</span>
            <span>â‚©2,000,000</span>
          </div>
        </div>
      </div>
      <div class="timeline-item">
        <div class="timeline-dot lose"></div>
        <div class="timeline-content">
          <div class="timeline-title">XXì•± UI/UX ê³µëª¨ì „</div>
          <div class="timeline-meta">
            <span>2026.01</span>
            <span class="timeline-badge eliminated">ì‹¬ì‚¬íƒˆë½</span>
            <a href="#" class="timeline-link">í”¼ë“œë°± ë³´ê¸°</a>
          </div>
        </div>
      </div>
      <div class="timeline-item">
        <div class="timeline-dot win"></div>
        <div class="timeline-content">
          <div class="timeline-title">â–³â–³ë°ì´í„° ì‹œê°í™” ëŒ€íšŒ</div>
          <div class="timeline-meta">
            <span>2025.12</span>
            <span class="timeline-badge award">ëŒ€ìƒ</span>
            <span>â‚©5,000,000</span>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- ì•ˆë‚´ ëª¨ë‹¬: í‹°ì–´ ì‹œìŠ¤í…œ -->
  <div class="modal-overlay" id="modalTier">
    <div class="modal-box">
      <div class="modal-header">
        <h4>ğŸ† ìˆ˜ìƒ Tier ì‹œìŠ¤í…œ</h4>
        <button type="button" class="modal-close" onclick="closeModal('modalTier')" aria-label="ë‹«ê¸°">Ã—</button>
      </div>
      <div class="modal-body">
        <p>ìˆ˜ìƒ íšŸìˆ˜ì— ë”°ë¼ í”„ë¡œí•„ ì˜ì—­ì˜ ë¹„ì£¼ì–¼ì´ ì—…ê·¸ë ˆì´ë“œë©ë‹ˆë‹¤.</p>
        <table>
          <thead><tr><th>Tier</th><th>ì¡°ê±´</th><th>íš¨ê³¼</th></tr></thead>
          <tbody>
            <tr><td>Tier 0</td><td>ìˆ˜ìƒ 0íšŒ</td><td>ê¸°ë³¸ í° ë°°ê²½</td></tr>
            <tr><td>Tier 1</td><td>ìˆ˜ìƒ 1~2íšŒ</td><td>ì‹¤ë²„ í…Œë‘ë¦¬ + ì•„ë°”íƒ€ ì‹¤ë²„ ê¸€ë¡œìš°</td></tr>
            <tr><td>Tier 2</td><td>ìˆ˜ìƒ 3~4íšŒ</td><td>ê³¨ë“œ ë°°ê²½ + íšŒì „ ê³¨ë“œ ë³´ë” + shimmer íš¨ê³¼</td></tr>
            <tr><td>Tier 3</td><td>ìˆ˜ìƒ 5íšŒ ì´ìƒ</td><td>ë‹¤í¬ ë°°ê²½ + íŒŒí‹°í´ + ë¬´ì§€ê°œ ë³´ë” + LEGEND ë±ƒì§€</td></tr>
          </tbody>
        </table>
        <p style="font-size:0.85rem;color:var(--gray-muted);margin-top:12px;">ê³µëª¨ì „ ìˆ˜ìƒ ì‹¤ì ì´ ìŒ“ì¼ìˆ˜ë¡ ë” í™”ë ¤í•œ í”„ë¡œí•„ì„ ê°–ê²Œ ë©ë‹ˆë‹¤.</p>
      </div>
    </div>
  </div>

  <!-- ì•ˆë‚´ ëª¨ë‹¬: ë¶„ì•¼ íƒœê·¸ -->
  <div class="modal-overlay" id="modalTags">
    <div class="modal-box">
      <div class="modal-header">
        <h4># ë¶„ì•¼ ì „ë¬¸ì„± íƒœê·¸</h4>
        <button type="button" class="modal-close" onclick="closeModal('modalTags')" aria-label="ë‹«ê¸°">Ã—</button>
      </div>
      <div class="modal-body">
        <p>ì°¸ì—¬í•œ ê³µëª¨ì „Â·ìˆ˜ìƒ ë¶„ì•¼ ë°ì´í„°ê°€ ìŒ“ì´ë©´ ìë™ìœ¼ë¡œ í•´ë‹¹ íƒœê·¸ê°€ í”„ë¡œí•„ì— ì¶”ê°€ë©ë‹ˆë‹¤.</p>
        <table>
          <thead><tr><th>íƒœê·¸</th><th>ìë™ ì¶”ê°€ ì¡°ê±´</th></tr></thead>
          <tbody>
            <tr><td>#ë¹…ë°ì´í„°</td><td>ë¹…ë°ì´í„°/ë°ì´í„° ì‹œê°í™” ë¶„ì•¼ ê³µëª¨ì „ 1íšŒ ì´ìƒ ì°¸ì—¬ ë˜ëŠ” ìˆ˜ìƒ</td></tr>
            <tr><td>#AI ë””ìì¸</td><td>AIÂ·ìƒì„±í˜• ë””ìì¸ ë¶„ì•¼ ê³µëª¨ì „ 1íšŒ ì´ìƒ ì°¸ì—¬ ë˜ëŠ” ìˆ˜ìƒ</td></tr>
            <tr><td>#ë¡œê³  ë””ìì¸</td><td>ë¡œê³ Â·ë¸Œëœë”©Â·CI ë¶„ì•¼ ê³µëª¨ì „ 1íšŒ ì´ìƒ ì°¸ì—¬ ë˜ëŠ” ìˆ˜ìƒ</td></tr>
            <tr><td>#UX/UI</td><td>UXÂ·UIÂ·ì•± ë””ìì¸ ë¶„ì•¼ ê³µëª¨ì „ 1íšŒ ì´ìƒ ì°¸ì—¬ ë˜ëŠ” ìˆ˜ìƒ</td></tr>
            <tr><td>#í¬ìŠ¤í„°</td><td>í¬ìŠ¤í„°Â·ê·¸ë˜í”½ ë””ìì¸ ë¶„ì•¼ 1íšŒ ì´ìƒ ì°¸ì—¬ ë˜ëŠ” ìˆ˜ìƒ</td></tr>
            <tr><td>#ì˜ìƒ</td><td>ì˜ìƒÂ·UCCÂ·ê´‘ê³  ë¶„ì•¼ 1íšŒ ì´ìƒ ì°¸ì—¬ ë˜ëŠ” ìˆ˜ìƒ</td></tr>
            <tr><td>#ìºë¦­í„°</td><td>ìºë¦­í„°Â·ì¼ëŸ¬ìŠ¤íŠ¸ ë¶„ì•¼ 1íšŒ ì´ìƒ ì°¸ì—¬ ë˜ëŠ” ìˆ˜ìƒ</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ì•ˆë‚´ ëª¨ë‹¬: ìë™ í—¤ë“œë¼ì¸ -->
  <div class="modal-overlay" id="modalHeadline">
    <div class="modal-box">
      <div class="modal-header">
        <h4>âœ¨ ìë™ ìƒì„± í—¤ë“œë¼ì¸</h4>
        <button type="button" class="modal-close" onclick="closeModal('modalHeadline')" aria-label="ë‹«ê¸°">Ã—</button>
      </div>
      <div class="modal-body">
        <p>ì—­ëŸ‰ì´ ìŒ“ì´ë©´ í”„ë¡œí•„ì— ë…¸ì¶œë˜ëŠ” í•œ ì¤„ ìê¸°ì†Œê°œê°€ ìë™ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œë©ë‹ˆë‹¤. íƒ€ì¸ì´ í”„ë¡œí•„ ë°©ë¬¸ ì‹œ ì¦‰ì‹œ ì¸ìƒì ì…ë‹ˆë‹¤.</p>
        <div class="info-item">
          <strong>ìƒˆë¡œìš´ ë„ì „ì„ ì‹œì‘í•´ë³´ì„¸ìš”</strong><br>
          ì¡°ê±´: Tier 0 (ìˆ˜ìƒ ì—†ìŒ)
        </div>
        <div class="info-item">
          <strong>ìˆ˜ìƒ í¬ë¦¬ì—ì´í„° Â· SILVER Tier</strong><br>
          ì¡°ê±´: ìˆ˜ìƒ 1~2íšŒ (Tier 1 ë‹¬ì„±)
        </div>
        <div class="info-item">
          <strong>AI ë””ìì¸ ë¶„ì•¼ ìƒìœ„ 5% Â· GOLD í¬ë¦¬ì—ì´í„°</strong><br>
          ì¡°ê±´: ìˆ˜ìƒ 3~4íšŒ + í•´ë‹¹ ë¶„ì•¼ì—ì„œ ìƒìœ„ ìˆœìœ„ (Tier 2)
        </div>
        <div class="info-item">
          <strong>AI ë””ìì¸ ë¶„ì•¼ ëˆ„ì  ìƒê¸ˆ 1ìœ„ Â· ë ˆì „ë“œ í¬ë¦¬ì—ì´í„°</strong><br>
          ì¡°ê±´: ìˆ˜ìƒ 5íšŒ ì´ìƒ + ë¶„ì•¼ ë‚´ ìƒê¸ˆ 1ìœ„ (Tier 3)
        </div>
        <div class="info-item">
          <strong>[ì¶”ê°€ ì˜ˆì •] ë¶„ì•¼ë³„ ë¬¸ì¥</strong><br>
          ë¶„ì•¼ë³„ë¡œ "ë¡œê³  ë””ìì¸ ìˆ˜ìƒ 3íšŒ" ë“± ë°ì´í„°ì— ë§ëŠ” ë¬¸ì¥ì´ ìë™ ìƒì„±ë©ë‹ˆë‹¤.
        </div>
      </div>
    </div>
  </div>

  {% include 'partials/_sidebar_users.html' %}
  {% include 'partials/_toast.html' %}

  <script>
    function openModal(id) {
      const el = document.getElementById(id);
      if (el) { el.classList.add('active'); document.body.style.overflow = 'hidden'; }
    }
    function closeModal(id) {
      const el = document.getElementById(id);
      if (el) { el.classList.remove('active'); document.body.style.overflow = ''; }
    }
    document.querySelectorAll('.modal-overlay').forEach(function(overlay) {
      overlay.addEventListener('click', function(e) {
        if (e.target === overlay) closeModal(overlay.id);
      });
    });
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') document.querySelectorAll('.modal-overlay.active').forEach(function(m) { closeModal(m.id); });
    });

    const avatarInput = document.getElementById('avatarInput');
    if (avatarInput) {
    avatarInput.addEventListener('change', async function(e) {
      const file = e.target.files?.[0];
      if (!file) return;
      const formData = new FormData();
      formData.append('file', file);
      try {
        const r = await fetch('/api/profile/update-image', { method: 'POST', body: formData });
        const j = await r.json();
        if (j.success && j.profile_url) {
          location.reload();
        } else {
          showToast(j.error || 'ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        }
      } catch (err) {
        showToast('ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
      }
      e.target.value = '';
    });
    }

    // ìƒíƒœ ë©”ì‹œì§€ ì €ì¥ (blur ì‹œ)
    const statusInput = document.getElementById('statusInput');
    if (statusInput) {
      let saveTimeout = null;
      function saveStatusMessage(isDelete) {
        const val = (statusInput.value || '').trim();
        fetch('/api/profile/status-message', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ status_message: val })
        }).then(r => r.json()).then(j => {
          if (j.success) showToast(isDelete || !val ? 'ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          else showToast(j.error || 'ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
        });
      }
      statusInput.addEventListener('blur', saveStatusMessage);
      statusInput.addEventListener('input', function() {
        clearTimeout(saveTimeout);
        saveTimeout = setTimeout(saveStatusMessage, 800);
      });
      const btnSave = document.getElementById('btnSaveStatus');
      if (btnSave) btnSave.addEventListener('click', saveStatusMessage);
      const btnClear = document.getElementById('btnClearStatus');
      if (btnClear) {
        btnClear.addEventListener('click', function() {
          statusInput.value = '';
          saveStatusMessage(true);
        });
      }
    }

    // ìµœê·¼ ë³¸ ê³µëª¨ì „ ë¡œë“œ (ë‚´ í”„ë¡œí•„ì¼ ë•Œë§Œ - íƒ€ì„ë¼ì¸ ì—°ë™ ì˜ˆì •)
    (async function() {
      const ul = document.getElementById('recentContests');
      if (!ul) return;
      try {
        const raw = localStorage.getItem('allyoung_viewed');
        const ids = raw ? JSON.parse(raw) : [];
        if (ids.length === 0) return;
        const r = await fetch('/api/contests/by-ids?ids=' + ids.slice(-10).reverse().join(','));
        const j = await r.json();
        if (!j.success || !j.data || j.data.length === 0) return;
        ul.innerHTML = j.data.slice(0, 5).map(c =>
          '<li><a href="' + (c.url || '#') + '" target="_blank">' + (c.title || '-') + '</a></li>'
        ).join('');
      } catch (_) {}
    })();
  </script>
</body>
</html>
